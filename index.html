<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ÂàùÈü≥„Éü„ÇØ ‚Äî Hatsune Miku</title>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@300;400;500;600;700&family=Share+Tech+Mono&display=swap" rel="stylesheet" />
  <style>
    *{margin:0;padding:0;box-sizing:border-box}
    :root{
      --cyan:#39c5bb;--cyan-glow:rgba(57,197,187,0.4);
      --pink:#ff4081;--purple:#7c4dff;--dark:#0a0a1a;--darker:#050510;
      --text:#e0f7fa;--text-dim:rgba(224,247,250,0.5);
    }
    html{scroll-behavior:smooth}
    body{font-family:'Rajdhani',sans-serif;background:var(--dark);color:var(--text);overflow-x:hidden;cursor:none}

    .cursor{position:fixed;pointer-events:none;z-index:10000;width:20px;height:20px;border-radius:50%;
      border:2px solid var(--cyan);transform:translate(-50%,-50%);transition:width .15s,height .15s;
      box-shadow:0 0 15px var(--cyan-glow),inset 0 0 8px var(--cyan-glow)}
    .cursor-trail{position:fixed;pointer-events:none;z-index:9999;width:6px;height:6px;border-radius:50%;
      background:var(--cyan);opacity:0;will-change:transform,opacity}

    .scanlines{position:fixed;inset:0;z-index:9990;pointer-events:none;
      background:repeating-linear-gradient(0deg,transparent,transparent 2px,rgba(0,0,0,0.03) 2px,rgba(0,0,0,0.03) 4px)}

    /* === FUTURISTIC LOADER === */
    .loader{position:fixed;inset:0;z-index:99999;overflow:hidden;perspective:1200px;
      background:radial-gradient(ellipse at center,var(--darker) 0%,#020205 100%);
      transition:opacity 1s cubic-bezier(0.4,0,0.2,1),visibility 1s}
    .loader.hidden{opacity:0;visibility:hidden;pointer-events:none}
    
    /* Parallax Background Layers */
    .parallax-container{position:absolute;inset:0;transform-style:preserve-3d}
    .parallax-layer{position:absolute;inset:-20%;will-change:transform}
    
    /* Deep space layer - slowest */
    .parallax-far{
      background:
        radial-gradient(2px 2px at 20px 30px,rgba(57,197,187,0.3),transparent),
        radial-gradient(1px 1px at 50px 100px,rgba(255,64,129,0.2),transparent),
        radial-gradient(2px 2px at 80px 50px,rgba(124,77,255,0.2),transparent),
        radial-gradient(1px 1px at 130px 80px,rgba(57,197,187,0.25),transparent),
        radial-gradient(2px 2px at 160px 120px,rgba(255,64,129,0.15),transparent);
      background-size:200px 200px,150px 150px,180px 180px,220px 220px,170px 170px;
      animation:starfield 200s linear infinite;
    }
    @keyframes starfield{to{background-position:200px 200px,-150px 150px,180px -180px,-220px 220px,170px -170px}}
    
    /* Constellation layer */
    .constellation-canvas{position:absolute;inset:0;opacity:0.4}
    
    /* Grid layer */
    .grid-layer{position:absolute;inset:0;
      background-image:
        linear-gradient(rgba(57,197,187,0.03) 1px,transparent 1px),
        linear-gradient(90deg,rgba(57,197,187,0.03) 1px,transparent 1px);
      background-size:50px 50px;
      transform:rotateX(60deg) translateY(-100px) translateZ(-200px);
      animation:gridMove 20s linear infinite}
    @keyframes gridMove{to{background-position:0 50px}}
    
    /* Hex pattern overlay */
    .hex-grid{position:absolute;inset:0;opacity:0.06;
      background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='28' height='49' viewBox='0 0 28 49'%3E%3Cg fill-rule='evenodd'%3E%3Cg fill='%2339c5bb' fill-opacity='0.4'%3E%3Cpath d='M13.99 9.25l13 7.5v15l-13 7.5L1 31.75v-15l12.99-7.5zM3 17.9v12.7l10.99 6.34 11-6.35V17.9l-11-6.34L3 17.9zM0 15l12.98-7.5V0h-2v6.35L0 12.69v2.3zm0 18.5L12.98 41v8h-2v-6.85L0 35.81v-2.3zM15 0v7.5L27.99 15H28v-2.31h-.01L17 6.35V0h-2zm0 49v-8l12.99-7.5H28v2.31h-.01L17 42.15V49h-2z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
      animation:hexPulse 4s ease-in-out infinite}
    @keyframes hexPulse{0%,100%{opacity:0.04}50%{opacity:0.1}}
    
    /* Central HUD Container */
    .loader-hud{position:relative;z-index:10;display:flex;flex-direction:column;align-items:center;justify-content:center;
      min-height:100vh;transform-style:preserve-3d}
    
    /* 3D Holographic Rings */
    .holo-container{position:absolute;width:400px;height:400px;transform-style:preserve-3d;
      animation:holoFloat 6s ease-in-out infinite}
    @keyframes holoFloat{0%,100%{transform:translateY(0) rotateX(10deg)}50%{transform:translateY(-20px) rotateX(15deg)}}
    
    .holo-ring{position:absolute;inset:0;border-radius:50%;border:1px solid transparent;
      background:linear-gradient(135deg,var(--cyan),var(--pink),var(--purple)) border-box;
      -webkit-mask:linear-gradient(#fff 0 0) padding-box,linear-gradient(#fff 0 0);
      mask:linear-gradient(#fff 0 0) padding-box,linear-gradient(#fff 0 0);
      -webkit-mask-composite:xor;mask-composite:exclude;
      animation:holoSpin 8s linear infinite}
    .holo-ring:nth-child(2){inset:30px;animation-duration:12s;animation-direction:reverse;opacity:0.6}
    .holo-ring:nth-child(3){inset:60px;animation-duration:15s;opacity:0.4}
    .holo-ring:nth-child(4){inset:-30px;border-style:dashed;animation-duration:20s;opacity:0.3}
    
    @keyframes holoSpin{to{transform:rotateZ(360deg) rotateX(60deg)}}
    
    /* Inner glow pulse */
    .holo-glow{position:absolute;inset:80px;border-radius:50%;
      background:radial-gradient(circle,rgba(57,197,187,0.1) 0%,transparent 70%);
      animation:glowPulse 3s ease-in-out infinite}
    @keyframes glowPulse{0%,100%{transform:scale(1);opacity:0.5}50%{transform:scale(1.1);opacity:0.8}}
    
    /* Corner Brackets Frame */
    .hud-frame{position:absolute;inset:40px;pointer-events:none}
    .hud-frame::before,.hud-frame::after,.hud-frame .corner-bl,.hud-frame .corner-br{content:'';
      position:absolute;width:60px;height:60px;border-color:var(--cyan);border-style:solid}
    .hud-frame::before{top:0;left:0;border-width:3px 0 0 3px}
    .hud-frame::after{top:0;right:0;border-width:3px 3px 0 0}
    .hud-frame .corner-bl{bottom:0;left:0;border-width:0 0 3px 3px}
    .hud-frame .corner-br{bottom:0;right:0;border-width:0 3px 3px 0}
    
    /* Scanning laser line */
    .scan-laser{position:absolute;left:0;right:0;height:2px;background:linear-gradient(90deg,transparent,var(--cyan),transparent);
      box-shadow:0 0 20px var(--cyan),0 0 40px var(--cyan-glow);opacity:0.6;animation:scanMove 3s ease-in-out infinite}
    @keyframes scanMove{0%,100%{top:20%;opacity:0}10%{opacity:0.6}90%{opacity:0.6}100%{top:80%;opacity:0}}
    
    /* Content */
    .hud-content{position:relative;z-index:20;text-align:center;transform:translateZ(50px)}
    
    .loader-init{font-family:'Share Tech Mono',monospace;font-size:0.7rem;color:var(--cyan);letter-spacing:0.4em;
      text-transform:uppercase;margin-bottom:20px;opacity:0}
    .loader-init.visible{animation:flicker 0.1s 0s 5 alternate forwards,fadeIn 0.5s forwards}
    
    .loader-title{font-family:'Orbitron',monospace;font-size:4rem;font-weight:900;color:#fff;letter-spacing:0.1em;
      text-shadow:0 0 40px var(--cyan-glow),0 0 80px rgba(57,197,187,0.3),0 0 120px rgba(57,197,187,0.1);
      position:relative;opacity:0;height:1.2em}
    .loader-title.visible{animation:decoderReveal 1.5s forwards,glitchFloat 4s ease-in-out infinite 1.5s}
    
    .loader-title::before,.loader-title::after{content:attr(data-text);position:absolute;top:0;left:0;width:100%;height:100%;
      opacity:0;pointer-events:none}
    .loader-title.glitching::before{color:var(--pink);clip-path:inset(30% 0 50% 0);transform:translate(-3px);animation:glitchLayer1 0.3s}
    .loader-title.glitching::after{color:var(--cyan);clip-path:inset(50% 0 30% 0);transform:translate(3px);animation:glitchLayer2 0.3s}
    
    @keyframes decoderReveal{
      0%{opacity:0;filter:blur(10px)}
      20%{opacity:1;filter:blur(0)}
      100%{opacity:1}
    }
    @keyframes glitchFloat{0%,100%{transform:translate(0)}25%{transform:translate(1px,-1px)}75%{transform:translate(-1px,1px)}}
    @keyframes glitchLayer1{0%,100%{opacity:0}20%,80%{opacity:0.8}}
    @keyframes glitchLayer2{0%,100%{opacity:0}20%,80%{opacity:0.8}}
    
    .loader-sub{font-family:'Share Tech Mono',monospace;font-size:0.85rem;color:var(--text-dim);letter-spacing:0.25em;
      text-transform:uppercase;margin-top:16px;opacity:0}
    .loader-sub.visible{animation:fadeIn 0.6s forwards,typingDecode 2s steps(30) forwards}
    
    @keyframes typingDecode{from{clip-path:inset(0 100% 0 0)}to{clip-path:inset(0 0 0 0)}}
    
    /* Audio Visualizer */
    .audio-viz{position:relative;height:60px;display:flex;align-items:flex-end;justify-content:center;
      gap:4px;margin:30px 0;opacity:0}
    .audio-viz.visible{animation:fadeIn 0.5s forwards}
    .viz-bar{width:6px;background:linear-gradient(180deg,var(--cyan),var(--pink));border-radius:3px;
      box-shadow:0 0 10px var(--cyan-glow);animation:vizDance 0.5s ease-in-out infinite alternate}
    .viz-bar:nth-child(odd){animation-duration:0.4s;animation-delay:0.1s}
    .viz-bar:nth-child(3n){animation-duration:0.6s;animation-delay:0.2s}
    @keyframes vizDance{from{height:10px}to{height:50px}}
    
    /* Progress Section */
    .loader-progress{width:320px;margin-top:20px;opacity:0}
    .loader-progress.visible{animation:fadeIn 0.5s forwards}
    
    .progress-header{display:flex;justify-content:space-between;font-family:'Share Tech Mono',monospace;font-size:10px;
      color:var(--text-dim);margin-bottom:8px;letter-spacing:0.15em}
    .progress-bar{height:3px;background:rgba(57,197,187,0.1);border-radius:2px;overflow:hidden;position:relative}
    .progress-bar::before{content:'';position:absolute;inset:0;
      background:linear-gradient(90deg,transparent,rgba(57,197,187,0.4),transparent);
      animation:progressShine 2s infinite}
    @keyframes progressShine{0%{transform:translateX(-100%)}100%{transform:translateX(100%)}}
    
    .progress-fill{height:100%;width:0;background:linear-gradient(90deg,var(--cyan),var(--pink),var(--purple));border-radius:2px;
      box-shadow:0 0 15px var(--cyan-glow);transition:width 0.1s linear;position:relative}
    .progress-fill::after{content:'';position:absolute;right:0;top:0;bottom:0;width:20px;
      background:linear-gradient(90deg,transparent,#fff);opacity:0.8;animation:pulseTail 0.5s infinite}
    @keyframes pulseTail{0%,100%{opacity:0.4}50%{opacity:1}}
    
    .progress-percent{font-family:'Orbitron',monospace;font-size:2.5rem;color:var(--cyan);text-align:center;margin-top:20px;
      text-shadow:0 0 20px var(--cyan-glow);opacity:0;font-variant-numeric:tabular-nums}
    .progress-percent.visible{animation:fadeIn 0.5s forwards,countUp 0.1s steps(100)}
    
    /* Terminal logs - left side */
    .terminal-logs{position:absolute;left:40px;top:50%;transform:translateY(-50%);width:300px;
      font-family:'Share Tech Mono',monospace;font-size:11px;color:var(--cyan);opacity:0.7;
      text-align:left;z-index:5;pointer-events:none}
    .terminal-logs .log-line{display:block;margin:6px 0;padding:4px 8px;border-left:2px solid transparent;
      animation:logSlide 0.3s ease forwards;opacity:0;transform:translateX(-20px)}
    .terminal-logs .log-line.active{border-left-color:var(--cyan);background:linear-gradient(90deg,rgba(57,197,187,0.1),transparent)}
    .terminal-logs .log-time{color:rgba(57,197,187,0.5);margin-right:8px;font-size:10px}
    .terminal-logs .log-ok{color:#4caf50}
    .terminal-logs .log-warn{color:#ff9800}
    .terminal-logs .log-info{color:#2196f3}
    .terminal-logs .log-error{color:#f44336}
    @keyframes logSlide{to{opacity:1;transform:translateX(0)}}
    
    /* System stats - right side */
    .sys-stats{position:absolute;right:40px;top:50%;transform:translateY(-50%);width:220px;
      font-family:'Share Tech Mono',monospace;font-size:11px;color:var(--text-dim);opacity:0.7;
      text-align:right;z-index:5;pointer-events:none}
    .sys-stats .stat-row{display:flex;justify-content:flex-end;align-items:center;gap:12px;margin:8px 0}
    .sys-stats .stat-label{min-width:40px}
    .sys-stats .stat-value{color:var(--cyan);min-width:50px}
    .sys-stats .stat-bar{width:100px;height:4px;background:rgba(57,197,187,0.1);border-radius:2px;overflow:hidden}
    .sys-stats .stat-fill{height:100%;background:linear-gradient(90deg,var(--cyan),var(--pink));border-radius:2px;transition:width 0.3s}
    
    /* Neural Network Visualization */
    .neural-canvas{position:absolute;right:40px;bottom:40px;width:200px;height:150px;opacity:0.5;pointer-events:none}
    
    /* Bottom status line */
    .loader-status{position:absolute;bottom:40px;left:50%;transform:translateX(-50%);
      font-family:'Share Tech Mono',monospace;font-size:11px;color:var(--text-dim);
      letter-spacing:0.2em;opacity:0;white-space:nowrap}
    .loader-status.visible{animation:fadeIn 0.5s forwards}
    .loader-status::before{content:'[';color:var(--cyan);margin-right:8px}
    .loader-status::after{content:']';color:var(--cyan);margin-left:8px}
    .loader-status .cursor-blink{animation:blink 1s infinite}
    @keyframes blink{0%,50%{opacity:1}51%,100%{opacity:0}}
    
    @keyframes flicker{0%{opacity:0}100%{opacity:1}}
    @keyframes fadeIn{to{opacity:1}}
    
    @media(max-width:768px){
      .loader-title{font-size:2rem}
      .holo-container{width:250px;height:250px}
      .terminal-logs,.sys-stats,.neural-canvas{display:none}
      .loader-progress{width:260px}
      .audio-viz{gap:2px}
      .viz-bar{width:4px}
    }

    #threeCanvas{position:fixed;inset:0;z-index:0;pointer-events:none}

    .site-header{position:fixed;top:0;left:0;right:0;z-index:60;padding:20px 48px;display:flex;justify-content:space-between;
      align-items:center;transition:background .5s,backdrop-filter .5s}
    .site-header.scrolled{background:rgba(10,10,26,0.92);backdrop-filter:blur(12px);border-bottom:1px solid rgba(57,197,187,0.1)}
    .logo{font-family:'Orbitron',monospace;font-size:1.1rem;color:var(--cyan);text-decoration:none;letter-spacing:.1em;
      text-shadow:0 0 10px var(--cyan-glow)}
    .logo span{color:var(--pink)}
    .nav-links{display:flex;gap:28px;align-items:center}
    .nav-links a{color:var(--text-dim);text-decoration:none;font-size:.75rem;letter-spacing:.1em;text-transform:uppercase;
      font-family:'Orbitron',monospace;transition:color .3s,text-shadow .3s}
    .nav-links a:hover{color:var(--cyan);text-shadow:0 0 10px var(--cyan-glow)}

    .glitch{position:relative}
    .glitch::before,.glitch::after{content:attr(data-text);position:absolute;top:0;left:0;width:100%;height:100%;opacity:0}
    .glitch:hover::before{opacity:.8;color:var(--pink);animation:glitchClip 0.3s infinite alternate-reverse;clip-path:inset(20% 0 30% 0)}
    .glitch:hover::after{opacity:.8;color:var(--cyan);animation:glitchClip 0.3s 0.1s infinite alternate;clip-path:inset(50% 0 10% 0)}
    @keyframes glitchClip{
      0%{clip-path:inset(20% 0 60% 0);transform:translate(-2px)}
      25%{clip-path:inset(50% 0 10% 0);transform:translate(2px)}
      50%{clip-path:inset(10% 0 40% 0);transform:translate(-1px)}
      75%{clip-path:inset(60% 0 5% 0);transform:translate(1px)}
      100%{clip-path:inset(30% 0 30% 0);transform:translate(0)}
    }

    /* Hero */
    .hero{position:relative;height:100vh;display:flex;align-items:center;justify-content:center;overflow:hidden}
    .hero-model{position:absolute;inset:0;z-index:1}
    .hero-model iframe{width:100%;height:100%;border:none}
    .hero-overlay{position:absolute;inset:0;z-index:2;
      background:linear-gradient(180deg,rgba(5,5,16,0.3) 0%,rgba(5,5,16,0.1) 40%,rgba(5,5,16,0.7) 100%);pointer-events:none}
    .hero-content{position:relative;z-index:3;text-align:center;pointer-events:none}
    .hero-content h1{font-family:'Orbitron',monospace;font-size:3.5rem;font-weight:900;color:#fff;letter-spacing:.06em;
      text-shadow:0 0 40px var(--cyan-glow),0 0 80px rgba(57,197,187,0.15);
      opacity:0;animation:heroSlide 1s 4.5s ease forwards}
    .hero-content .hero-jp{font-family:'Orbitron',monospace;font-size:1rem;color:var(--cyan);letter-spacing:.3em;margin-bottom:12px;
      opacity:0;animation:heroSlide .8s 4.2s ease forwards}
    .hero-content p{font-size:1.1rem;color:var(--text-dim);letter-spacing:.12em;margin-top:16px;font-weight:300;
      opacity:0;animation:heroSlide .8s 4.8s ease forwards}
    .hero-scroll{position:absolute;bottom:40px;left:50%;transform:translateX(-50%);z-index:3;
      color:var(--text-dim);font-size:.65rem;letter-spacing:.2em;text-transform:uppercase;text-decoration:none;
      opacity:0;animation:heroSlide .8s 5.2s ease forwards}
    .hero-scroll::after{content:'';display:block;width:1px;height:40px;
      background:linear-gradient(180deg,var(--cyan),transparent);margin:12px auto 0;animation:pulse 2s infinite}
    @keyframes heroSlide{to{opacity:1;transform:translateY(0)}}
    @keyframes pulse{0%,100%{opacity:.3}50%{opacity:1}}

    /* === LIVE2D MIKU === */
    .live2d-container{position:fixed;right:-50px;bottom:80px;width:350px;height:450px;z-index:55;pointer-events:none;
      opacity:0;transform:translateY(50px);transition:opacity 0.8s ease,transform 0.8s ease}
    .live2d-container.visible{opacity:1;transform:translateY(0)}
    .live2d-container canvas{pointer-events:auto;filter:drop-shadow(0 0 30px rgba(57,197,187,0.3))}
    .live2d-message{position:absolute;top:20px;left:20px;right:80px;background:rgba(5,5,16,0.95);border:1px solid var(--cyan);
      border-radius:12px;padding:12px 16px;font-size:13px;color:var(--text);opacity:0;transform:translateY(-10px);
      transition:opacity 0.3s,transform 0.3s;pointer-events:none;box-shadow:0 0 20px rgba(57,197,187,0.2)}
    .live2d-message.show{opacity:1;transform:translateY(0)}
    .live2d-message::after{content:'';position:absolute;bottom:-8px;right:30px;width:0;height:0;
      border-left:8px solid transparent;border-right:8px solid transparent;border-top:8px solid var(--cyan)}
    .live2d-toggle{position:fixed;right:20px;bottom:140px;width:44px;height:44px;border-radius:50%;
      background:rgba(5,5,16,0.9);border:2px solid var(--cyan);color:var(--cyan);cursor:none;z-index:56;
      display:flex;align-items:center;justify-content:center;font-size:18px;transition:all 0.3s;opacity:0;animation:fadeIn 0.5s 5.5s forwards}
    .live2d-toggle:hover{background:var(--cyan);color:var(--darker);box-shadow:0 0 20px var(--cyan-glow)}
    .live2d-toggle.hidden{display:none}

    /* Tracks section ‚Äî scattered floating */
    .tracks-section{position:relative;z-index:1;min-height:100vh;padding:120px 0 160px;overflow:visible}
    .tracks-section::before{content:'';position:absolute;top:0;left:0;right:0;height:1px;
      background:linear-gradient(90deg,transparent,var(--pink),transparent)}
    .tracks-title{text-align:center;margin-bottom:80px;position:relative;z-index:2}
    .tracks-title h2{font-family:'Orbitron',monospace;font-size:1.6rem;font-weight:700;color:var(--pink);letter-spacing:.15em;
      text-shadow:0 0 20px rgba(255,64,129,0.4)}
    .tracks-title p{color:var(--text-dim);font-size:.85rem;margin-top:8px;letter-spacing:.06em}

    .tracks-scatter{position:relative;max-width:1200px;margin:0 auto;height:900px}

    .disco-card{position:absolute;overflow:hidden;border-radius:8px;border:1px solid rgba(57,197,187,0.12);
      width:220px;cursor:none;opacity:0;
      transition:opacity .8s ease,border-color .4s,box-shadow .4s;
      animation:cardFloat 6s ease-in-out infinite}
    .disco-card.visible{opacity:1}
    .disco-card:hover{border-color:var(--cyan);box-shadow:0 0 35px var(--cyan-glow),0 4px 30px rgba(0,0,0,0.4)}
    .disco-card.playing{border-color:var(--pink);box-shadow:0 0 40px rgba(255,64,129,0.35),0 4px 30px rgba(0,0,0,0.4)}

    .disco-card .card-img{position:relative;width:100%;aspect-ratio:3/4;overflow:hidden}
    .disco-card img{width:100%;height:100%;object-fit:cover;transition:transform .6s ease}
    .disco-card:hover img{transform:scale(1.06)}
    .disco-card .static-overlay{position:absolute;inset:0;z-index:2;pointer-events:none;
      background:linear-gradient(180deg,rgba(20,60,80,0.5) 0%,rgba(10,30,50,0.65) 100%);transition:opacity .6s ease}
    .disco-card .static-overlay::before{content:'';position:absolute;inset:0;
      background:repeating-linear-gradient(0deg,transparent,transparent 1px,rgba(57,197,187,0.05) 1px,rgba(57,197,187,0.05) 2px);
      animation:staticScroll 0.4s linear infinite}
    .disco-card .static-overlay::after{content:'';position:absolute;inset:0;
      background:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 200 200'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.08'/%3E%3C/svg%3E");
      opacity:.5;animation:staticFlicker 0.15s steps(3) infinite}
    .disco-card.playing .static-overlay{opacity:0}

    .disco-card .play-icon{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%) scale(0.8);z-index:4;
      width:48px;height:48px;border-radius:50%;background:rgba(57,197,187,0.15);border:2px solid var(--cyan);
      display:flex;align-items:center;justify-content:center;opacity:0;transition:opacity .3s,transform .3s;
      box-shadow:0 0 20px var(--cyan-glow);backdrop-filter:blur(4px)}
    .disco-card .play-icon::after{content:'';width:0;height:0;border-style:solid;border-width:7px 0 7px 12px;
      border-color:transparent transparent transparent var(--cyan);margin-left:2px}
    .disco-card:hover .play-icon{opacity:1;transform:translate(-50%,-50%) scale(1)}
    .disco-card.playing .play-icon{opacity:1;border-color:var(--pink);background:rgba(255,64,129,0.15);
      box-shadow:0 0 20px rgba(255,64,129,0.3)}
    .disco-card.playing .play-icon::after{border-width:0;width:10px;height:12px;margin-left:0;
      border-left:3px solid var(--pink);border-right:3px solid var(--pink);background:transparent}

    .disco-card .card-label{padding:14px 14px 16px;background:rgba(5,5,16,0.9)}
    .disco-card .card-label h3{font-family:'Orbitron',monospace;font-size:.72rem;font-weight:700;color:#fff;letter-spacing:.04em;
      margin-bottom:3px;text-shadow:0 0 8px rgba(0,0,0,0.5)}
    .disco-card .card-label .song-artist{font-size:.62rem;color:var(--cyan);letter-spacing:.06em}

    /* Each card positioned uniquely */
    .disco-card:nth-child(1){left:5%;top:0;animation-delay:0s;transform:rotate(-3deg)}
    .disco-card:nth-child(2){right:8%;top:40px;animation-delay:-1.2s;transform:rotate(2deg)}
    .disco-card:nth-child(3){left:35%;top:280px;animation-delay:-2.5s;transform:rotate(-1.5deg)}
    .disco-card:nth-child(4){left:12%;top:520px;animation-delay:-3.8s;transform:rotate(2.5deg)}
    .disco-card:nth-child(5){right:15%;top:460px;animation-delay:-4.5s;transform:rotate(-2deg)}

    @keyframes cardFloat{
      0%,100%{transform:translateY(0) rotate(var(--rot,0deg))}
      50%{transform:translateY(-12px) rotate(var(--rot,0deg))}
    }
    .disco-card:nth-child(1){--rot:-3deg}
    .disco-card:nth-child(2){--rot:2deg}
    .disco-card:nth-child(3){--rot:-1.5deg}
    .disco-card:nth-child(4){--rot:2.5deg}
    .disco-card:nth-child(5){--rot:-2deg}

    @keyframes staticScroll{0%{transform:translateY(0)}100%{transform:translateY(4px)}}
    @keyframes staticFlicker{0%{opacity:.5}50%{opacity:.3}100%{opacity:.5}}

    /* Music player */
    .music-player{position:fixed;bottom:0;left:0;right:0;z-index:80;background:rgba(5,5,16,0.95);backdrop-filter:blur(12px);
      border-top:1px solid rgba(57,197,187,0.15);padding:12px 32px;display:flex;align-items:center;gap:20px;
      transform:translateY(100%);transition:transform .5s ease}
    .music-player.visible{transform:translateY(0)}
    .player-btn{background:none;border:2px solid var(--cyan);color:var(--cyan);width:36px;height:36px;border-radius:50%;
      cursor:none;font-size:1rem;display:flex;align-items:center;justify-content:center;transition:all .2s;flex-shrink:0}
    .player-btn:hover{background:var(--cyan);color:var(--darker)}
    .player-info{flex:1;min-width:0}
    .player-info .track-name{font-family:'Orbitron',monospace;font-size:.72rem;color:#fff;letter-spacing:.08em;
      white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    .player-info .track-artist{font-size:.65rem;color:var(--text-dim);letter-spacing:.06em;margin-top:2px}
    .player-progress{flex:2;height:3px;background:rgba(57,197,187,0.15);border-radius:2px;overflow:hidden;cursor:none}
    .player-progress-fill{height:100%;width:0;background:linear-gradient(90deg,var(--cyan),var(--pink));border-radius:2px;
      transition:width .1s linear}
    .player-time{font-family:'Orbitron',monospace;font-size:.6rem;color:var(--text-dim);letter-spacing:.06em;flex-shrink:0}
    .player-vol{display:flex;align-items:center;gap:8px;flex-shrink:0}
    .player-vol-icon{color:var(--text-dim);font-size:.8rem}
    .player-vol-bar{width:60px;height:3px;background:rgba(57,197,187,0.15);border-radius:2px;overflow:hidden;cursor:none}
    .player-vol-fill{height:100%;width:70%;background:var(--cyan);border-radius:2px}

    .site-footer{background:var(--darker);border-top:1px solid rgba(57,197,187,0.08);text-align:center;padding:40px;
      font-size:.68rem;color:var(--text-dim);letter-spacing:.08em;position:relative;z-index:1;padding-bottom:70px}
  </style>
</head>
<body>

<div class="cursor" id="cursor"></div>
<div class="scanlines"></div>

<!-- === FUTURISTIC LOADER === -->
<div class="loader" id="loader">
  <!-- Parallax Background -->
  <div class="parallax-container" id="parallaxContainer">
    <div class="parallax-layer parallax-far" data-speed="0.1"></div>
    <canvas class="constellation-canvas" id="constellationCanvas" data-speed="0.3"></canvas>
    <div class="grid-layer" data-speed="0.5"></div>
    <div class="hex-grid" data-speed="0.2"></div>
  </div>
  
  <!-- Neural Network Canvas -->
  <canvas class="neural-canvas" id="neuralCanvas"></canvas>
  
  <!-- Terminal Logs -->
  <div class="terminal-logs" id="terminalLogs"></div>
  
  <!-- System Stats -->
  <div class="sys-stats">
    <div class="stat-row"><span class="stat-label">CPU</span><div class="stat-bar"><div class="stat-fill" id="cpuStat" style="width:0%"></div></div><span class="stat-value" id="cpuVal">0%</span></div>
    <div class="stat-row"><span class="stat-label">MEM</span><div class="stat-bar"><div class="stat-fill" id="memStat" style="width:0%"></div></div><span class="stat-value" id="memVal">0%</span></div>
    <div class="stat-row"><span class="stat-label">NET</span><div class="stat-bar"><div class="stat-fill" id="netStat" style="width:0%"></div></div><span class="stat-value" id="netVal">0%</span></div>
    <div class="stat-row"><span class="stat-label">GPU</span><div class="stat-bar"><div class="stat-fill" id="gpuStat" style="width:0%"></div></div><span class="stat-value" id="gpuVal">0%</span></div>
  </div>
  
  <!-- Main HUD -->
  <div class="loader-hud" id="loaderHud">
    <!-- 3D Holographic Rings -->
    <div class="holo-container">
      <div class="holo-ring"></div>
      <div class="holo-ring"></div>
      <div class="holo-ring"></div>
      <div class="holo-ring"></div>
      <div class="holo-glow"></div>
    </div>
    
    <!-- Corner Frame -->
    <div class="hud-frame">
      <div class="corner-bl"></div>
      <div class="corner-br"></div>
    </div>
    
    <!-- Scanning Laser -->
    <div class="scan-laser"></div>
    
    <!-- Content -->
    <div class="hud-content">
      <div class="loader-init" id="loaderInit">SYSTEM INITIALIZATION</div>
      
      <div class="loader-title" id="loaderTitle" data-text="HATSUNE MIKU">HATSUNE MIKU</div>
      
      <div class="loader-sub" id="loaderSub">Virtual Diva Protocol v4.0</div>
      
      <!-- Audio Visualizer -->
      <div class="audio-viz" id="audioViz">
        <div class="viz-bar" style="height:15px"></div>
        <div class="viz-bar" style="height:30px"></div>
        <div class="viz-bar" style="height:20px"></div>
        <div class="viz-bar" style="height:40px"></div>
        <div class="viz-bar" style="height:25px"></div>
        <div class="viz-bar" style="height:35px"></div>
        <div class="viz-bar" style="height:18px"></div>
        <div class="viz-bar" style="height:45px"></div>
        <div class="viz-bar" style="height:22px"></div>
        <div class="viz-bar" style="height:38px"></div>
        <div class="viz-bar" style="height:28px"></div>
        <div class="viz-bar" style="height:32px"></div>
      </div>
      
      <!-- Progress -->
      <div class="loader-progress" id="loaderProgress">
        <div class="progress-header">
          <span id="progressLabel">INITIALIZING</span>
          <span id="progressStatus">CONNECTING...</span>
        </div>
        <div class="progress-bar">
          <div class="progress-fill" id="progressFill" style="width:0%"></div>
        </div>
      </div>
      
      <div class="progress-percent" id="progressPercent">0</div>
    </div>
  </div>
  
  <!-- Bottom Status -->
  <div class="loader-status" id="loaderStatus">PRESS ANY KEY TO INITIALIZE<span class="cursor-blink">_</span></div>
</div>

<canvas id="threeCanvas"></canvas>

<header class="site-header" id="siteHeader">
  <a class="logo glitch" data-text="MIKU//" href="#">MIKU<span>//</span></a>
  <nav class="nav-links" id="mainNav">
    <a href="#tracks">Tracks</a>
  </nav>
</header>

<section class="hero" id="hero">
  <div class="hero-model">
    <iframe title="Koi wa Sensou - Hatsune Miku 3D Model" src="https://sketchfab.com/models/e348c72a1ad041808f55c8ba92178a86/embed?autostart=1&ui_theme=dark&ui_infos=0&ui_controls=1&ui_stop=0&ui_inspector=0&ui_watermark=0&ui_watermark_link=0&ui_ar=0&ui_help=0&ui_settings=0&ui_vr=0&ui_fullscreen=0&ui_annotations=0&transparent=1" allow="autoplay; fullscreen; xr-spatial-tracking"></iframe>
  </div>
  <div class="hero-overlay"></div>
  <div class="hero-content">
    <div class="hero-jp">ÂàùÈü≥„Éü„ÇØ</div>
    <h1 class="glitch" data-text="HATSUNE MIKU">HATSUNE MIKU</h1>
    <p>The World's Virtual Diva</p>
  </div>
  <a class="hero-scroll" href="#tracks">Scroll to Begin</a>
</section>

<!-- === LIVE2D MIKU === -->
<div class="live2d-container" id="live2dContainer">
  <div class="live2d-message" id="live2dMessage">Hi there! I'm Miku! ‚ô™ Click on a song to play some music!</div>
  <canvas id="live2dCanvas"></canvas>
</div>
<button class="live2d-toggle" id="live2dToggle" title="Toggle Miku">üé§</button>

<section class="tracks-section" id="tracks">
  <div class="tracks-title">
    <h2>// SELECT TRACK</h2>
    <p>Click to play</p>
  </div>
  <div class="tracks-scatter">
    <div class="disco-card" data-video="9HrOqmiEsN8" onclick="playSong(this)">
      <div class="card-img">
        <img src="https://i.pinimg.com/736x/2f/ff/ec/2fffec9e19cf027dd997da28bf080916.jpg" alt="Romeo and Cinderella" />
        <div class="static-overlay"></div>
        <div class="play-icon"></div>
      </div>
      <div class="card-label"><h3>Romeo and Cinderella</h3><div class="song-artist">doriko</div></div>
    </div>
    <div class="disco-card" data-video="EuJ6UR_pD5s" onclick="playSong(this)">
      <div class="card-img">
        <img src="https://i.pinimg.com/1200x/4e/00/38/4e0038cf7d2a0ba2e675f1d6b91872ae.jpg" alt="World is Mine" />
        <div class="static-overlay"></div>
        <div class="play-icon"></div>
      </div>
      <div class="card-label"><h3>World is Mine</h3><div class="song-artist">ryo (supercell)</div></div>
    </div>
    <div class="disco-card" data-video="TNf3GPizM58" onclick="playSong(this)">
      <div class="card-img">
        <img src="https://i.pinimg.com/736x/5e/16/78/5e16781bc7b512ecc8ab2d8d89a5df9f.jpg" alt="Popipo" />
        <div class="static-overlay"></div>
        <div class="play-icon"></div>
      </div>
      <div class="card-label"><h3>Popipo</h3><div class="song-artist">Lamaze-P</div></div>
    </div>
    <div class="disco-card" data-video="5qkTpJAhywg" onclick="playSong(this)">
      <div class="card-img">
        <img src="https://i.pinimg.com/736x/46/a9/eb/46a9ebcc26907d875c5c68267f7dafbb.jpg" alt="The Disappearance of Hatsune Miku" />
        <div class="static-overlay"></div>
        <div class="play-icon"></div>
      </div>
      <div class="card-label"><h3>The Disappearance</h3><div class="song-artist">cosMo@Bousou-P</div></div>
    </div>
    <div class="disco-card" data-video="OLzOrik5YJ8" onclick="playSong(this)">
      <div class="card-img">
        <img src="https://i.pinimg.com/736x/e3/87/8b/e3878b5101120ba0cbb186eeebfeb28c.jpg" alt="Black Rock Shooter" />
        <div class="static-overlay"></div>
        <div class="play-icon"></div>
      </div>
      <div class="card-label"><h3>Black Rock Shooter</h3><div class="song-artist">ryo (supercell)</div></div>
    </div>
  </div>
  <div id="ytPlayer" style="position:absolute;width:1px;height:1px;overflow:hidden;opacity:0;pointer-events:none"></div>
</section>

<footer class="site-footer">
  &copy; 2025 Fan Tribute &mdash; Hatsune Miku belongs to Crypton Future Media
</footer>

<div class="music-player" id="musicPlayer">
  <button class="player-btn" id="playBtn" onclick="togglePlay()">&#9654;</button>
  <div class="player-info">
    <div class="track-name" id="trackName">Select a track</div>
    <div class="track-artist">Hatsune Miku</div>
  </div>
  <div class="player-progress" id="progressBar" onclick="seekTrack(event)">
    <div class="player-progress-fill" id="progressFill"></div>
  </div>
  <div class="player-time" id="playerTime">0:00 / 0:00</div>
  <div class="player-vol">
    <span class="player-vol-icon">&#128265;</span>
    <div class="player-vol-bar"><div class="player-vol-fill"></div></div>
  </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/pixi.js@7.x/dist/pixi.min.js"></script>
<script>
/* === ADVANCED FUTURISTIC LOADER === */
(function(){
  const chars='ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789@#$%^&*ÂàùÈü≥„Éü„ÇØ„Ç¢„Ç§„Ç¶„Ç®„Ç™„Ç´„Ç≠„ÇØ„Ç±„Ç≥';
  const finalText='HATSUNE MIKU';
  let decoded=false;
  
  // Decoder effect for title
  function decodeTitle(){
    const el=document.getElementById('loaderTitle');
    let iterations=0;
    const interval=setInterval(()=>{
      el.textContent=finalText.split('').map((char,index)=>{
        if(index<iterations)return finalText[index];
        return chars[Math.floor(Math.random()*chars.length)];
      }).join('');
      iterations+=1/3;
      if(iterations>=finalText.length){
        clearInterval(interval);
        el.textContent=finalText;
        el.classList.add('visible');
        triggerGlitch();
      }
    },50);
  }
  
  function triggerGlitch(){
    const el=document.getElementById('loaderTitle');
    el.classList.add('glitching');
    setTimeout(()=>el.classList.remove('glitching'),300);
  }
  
  // Reveal sequence
  setTimeout(()=>document.getElementById('loaderInit').classList.add('visible'),200);
  setTimeout(decodeTitle,800);
  setTimeout(()=>document.getElementById('loaderSub').classList.add('visible'),1500);
  setTimeout(()=>document.getElementById('audioViz').classList.add('visible'),1800);
  setTimeout(()=>document.getElementById('loaderProgress').classList.add('visible'),2000);
  setTimeout(()=>document.getElementById('progressPercent').classList.add('visible'),2200);
  setTimeout(()=>document.getElementById('loaderStatus').classList.add('visible'),3500);
})();

/* === PARALLAX EFFECT === */
(function(){
  const container=document.getElementById('parallaxContainer');
  const layers=container.querySelectorAll('.parallax-layer');
  let mouseX=0,mouseY=0;
  let currentX=0,currentY=0;
  
  document.addEventListener('mousemove',(e)=>{
    mouseX=(e.clientX/window.innerWidth-0.5)*2;
    mouseY=(e.clientY/window.innerHeight-0.5)*2;
  });
  
  function animate(){
    currentX+=(mouseX-currentX)*0.05;
    currentY+=(mouseY-currentY)*0.05;
    
    layers.forEach(layer=>{
      const speed=parseFloat(layer.dataset.speed)||0.1;
      const x=currentX*30*speed;
      const y=currentY*20*speed;
      layer.style.transform=`translate(${x}px,${y}px)`;
    });
    
    requestAnimationFrame(animate);
  }
  animate();
})();

/* === CONSTELLATION CANVAS === */
(function(){
  const canvas=document.getElementById('constellationCanvas');
  const ctx=canvas.getContext('2d');
  canvas.width=window.innerWidth;
  canvas.height=window.innerHeight;
  
  const particles=[];
  const particleCount=60;
  const connectionDistance=120;
  let mouseX=0,mouseY=0;
  
  for(let i=0;i<particleCount;i++){
    particles.push({
      x:Math.random()*canvas.width,
      y:Math.random()*canvas.height,
      vx:(Math.random()-0.5)*0.5,
      vy:(Math.random()-0.5)*0.5,
      radius:Math.random()*2+1
    });
  }
  
  document.addEventListener('mousemove',(e)=>{
    mouseX=e.clientX;
    mouseY=e.clientY;
  });
  
  window.addEventListener('resize',()=>{
    canvas.width=window.innerWidth;
    canvas.height=window.innerHeight;
  });
  
  function animate(){
    ctx.clearRect(0,0,canvas.width,canvas.height);
    
    particles.forEach((p,i)=>{
      // Mouse attraction
      const dx=mouseX-p.x;
      const dy=mouseY-p.y;
      const dist=Math.sqrt(dx*dx+dy*dy);
      if(dist<150){
        p.vx+=dx*0.0001;
        p.vy+=dy*0.0001;
      }
      
      p.x+=p.vx;
      p.y+=p.vy;
      
      // Bounce
      if(p.x<0||p.x>canvas.width)p.vx*=-1;
      if(p.y<0||p.y>canvas.height)p.vy*=-1;
      
      // Draw particle
      ctx.beginPath();
      ctx.arc(p.x,p.y,p.radius,0,Math.PI*2);
      ctx.fillStyle='rgba(57,197,187,0.6)';
      ctx.fill();
      
      // Connections
      for(let j=i+1;j<particles.length;j++){
        const p2=particles[j];
        const dx2=p.x-p2.x;
        const dy2=p.y-p2.y;
        const dist2=Math.sqrt(dx2*dx2+dy2*dy2);
        
        if(dist2<connectionDistance){
          ctx.beginPath();
          ctx.moveTo(p.x,p.y);
          ctx.lineTo(p2.x,p2.y);
          ctx.strokeStyle=`rgba(57,197,187,${0.2*(1-dist2/connectionDistance)})`;
          ctx.lineWidth=0.5;
          ctx.stroke();
        }
      }
    });
    
    requestAnimationFrame(animate);
  }
  animate();
})();

/* === NEURAL NETWORK CANVAS === */
(function(){
  const canvas=document.getElementById('neuralCanvas');
  if(!canvas)return;
  const ctx=canvas.getContext('2d');
  canvas.width=200;
  canvas.height=150;
  
  const nodes=[];
  const layers=[3,4,3];
  let time=0;
  
  // Create nodes
  let xOffset=40;
  layers.forEach((count,layerIndex)=>{
    const ySpacing=canvas.height/(count+1);
    for(let i=0;i<count;i++){
      nodes.push({
        x:xOffset,
        y:ySpacing*(i+1),
        layer:layerIndex,
        index:i,
        activation:0
      });
    }
    xOffset+=60;
  });
  
  function animate(){
    ctx.fillStyle='rgba(5,5,16,0.1)';
    ctx.fillRect(0,0,canvas.width,canvas.height);
    
    time+=0.05;
    
    // Update activations
    nodes.forEach(node=>{
      node.activation=Math.sin(time+node.layer*2+node.index)*0.5+0.5;
    });
    
    // Draw connections
    nodes.forEach(node=>{
      nodes.forEach(target=>{
        if(target.layer===node.layer+1){
          ctx.beginPath();
          ctx.moveTo(node.x,node.y);
          ctx.lineTo(target.x,target.y);
          const intensity=(node.activation+target.activation)/2;
          ctx.strokeStyle=`rgba(57,197,187,${intensity*0.3})`;
          ctx.lineWidth=intensity*1.5;
          ctx.stroke();
        }
      });
    });
    
    // Draw nodes
    nodes.forEach(node=>{
      ctx.beginPath();
      ctx.arc(node.x,node.y,4,0,Math.PI*2);
      ctx.fillStyle=`rgba(57,197,187,${0.3+node.activation*0.7})`;
      ctx.fill();
      
      ctx.beginPath();
      ctx.arc(node.x,node.y,8,0,Math.PI*2);
      ctx.strokeStyle=`rgba(57,197,187,${node.activation*0.3})`;
      ctx.lineWidth=1;
      ctx.stroke();
    });
    
    requestAnimationFrame(animate);
  }
  animate();
})();

/* === TERMINAL LOGS === */
const logs=[
  {t:0.3,msg:'Boot sequence initiated...',type:'info'},
  {t:0.6,msg:'Loading neural networks...',type:'info'},
  {t:0.9,msg:'Audio drivers initialized',type:'ok'},
  {t:1.2,msg:'Connecting to Vocaloid network...',type:'info'},
  {t:1.5,msg:'Handshake accepted',type:'ok'},
  {t:1.8,msg:'Loading 3D assets [sketchfab]...',type:'info'},
  {t:2.1,msg:'Live2D module active',type:'ok'},
  {t:2.4,msg:'Particle systems online',type:'ok'},
  {t:2.7,msg:'Audio visualizer ready',type:'ok'},
  {t:3.0,msg:'Holographic projection stable',type:'ok'},
  {t:3.3,msg:'Encryption verified [AES-256]',type:'ok'},
  {t:3.6,msg:'System ready',type:'ok'}
];

const terminalLogs=document.getElementById('terminalLogs');
logs.forEach(log=>{
  setTimeout(()=>{
    const line=document.createElement('span');
    line.className='log-line';
    const time=new Date().toLocaleTimeString('en-US',{hour12:false,hour:'2-digit',minute:'2-digit',second:'2-digit'});
    const typeColor=log.type==='ok'?'log-ok':log.type==='warn'?'log-warn':'log-info';
    line.innerHTML=`<span class="log-time">[${time}]</span><span class="${typeColor}">${log.msg}</span>`;
    terminalLogs.appendChild(line);
    if(terminalLogs.children.length>6)terminalLogs.removeChild(terminalLogs.firstChild);
    Array.from(terminalLogs.children).forEach(l=>l.classList.remove('active'));
    line.classList.add('active');
  },log.t*1000);
});

/* === PROGRESS & STATS === */
const progressFill=document.getElementById('progressFill');
const progressPercent=document.getElementById('progressPercent');
const progressStatus=document.getElementById('progressStatus');
let progress=0;

const progressInterval=setInterval(()=>{
  progress+=Math.random()*1.5+0.5;
  if(progress>=100){
    progress=100;
    clearInterval(progressInterval);
  }
  progressFill.style.width=progress+'%';
  progressPercent.textContent=Math.floor(progress);
  
  if(progress<25)progressStatus.textContent='CONNECTING...';
  else if(progress<50)progressStatus.textContent='LOADING ASSETS...';
  else if(progress<75)progressStatus.textContent='SYNCHRONIZING...';
  else if(progress<95)progressStatus.textContent='FINALIZING...';
  else progressStatus.textContent='READY';
  
  // Update stats
  document.getElementById('cpuStat').style.width=(20+Math.random()*50)+'%';
  document.getElementById('cpuVal').textContent=Math.floor(20+Math.random()*50)+'%';
  document.getElementById('memStat').style.width=(30+progress*0.6)+'%';
  document.getElementById('memVal').textContent=Math.floor(30+progress*0.6)+'%';
  document.getElementById('netStat').style.width=(40+Math.random()*40)+'%';
  document.getElementById('netVal').textContent=Math.floor(40+Math.random()*40)+'%';
  document.getElementById('gpuStat').style.width=(25+Math.random()*45)+'%';
  document.getElementById('gpuVal').textContent=Math.floor(25+Math.random()*45)+'%';
},60);

// Hide loader
setTimeout(()=>{
  document.getElementById('loader').classList.add('hidden');
},5200);

/* === CUSTOM CURSOR === */
(function(){
  var cursor=document.getElementById('cursor');
  var mx=-100,my=-100,cx=-100,cy=-100;
  var trails=[];
  for(var i=0;i<6;i++){
    var el=document.createElement('div');el.className='cursor-trail';
    document.body.appendChild(el);trails.push({el:el,x:-100,y:-100,life:0});
  }
  var lastTrail=0;
  document.addEventListener('mousemove',function(e){
    mx=e.clientX;my=e.clientY;
    var now=Date.now();
    if(now-lastTrail>50){
      lastTrail=now;var oldest=0,oldLife=trails[0].life;
      for(var i=1;i<trails.length;i++){if(trails[i].life<oldLife){oldLife=trails[i].life;oldest=i;}}
      trails[oldest].x=mx;trails[oldest].y=my;trails[oldest].life=1;
    }
  });
  function tick(){
    cx+=(mx-cx)*0.15;cy+=(my-cy)*0.15;
    cursor.style.left=cx+'px';cursor.style.top=cy+'px';
    for(var i=0;i<trails.length;i++){
      var t=trails[i];
      if(t.life>0){t.life-=0.03;if(t.life<=0){t.life=0;t.el.style.opacity=0;continue;}
        t.el.style.opacity=t.life*0.6;t.el.style.left=t.x+'px';t.el.style.top=t.y+'px';
        t.el.style.transform='translate(-50%,-50%) scale('+t.life+')';
      }
    }
    requestAnimationFrame(tick);
  }
  tick();
})();

/* === THREE.JS PARTICLES === */
(function(){
  var canvas=document.getElementById('threeCanvas');
  var renderer=new THREE.WebGLRenderer({canvas:canvas,alpha:true,antialias:true});
  renderer.setSize(window.innerWidth,window.innerHeight);
  renderer.setPixelRatio(Math.min(window.devicePixelRatio,2));
  var scene=new THREE.Scene();
  var camera=new THREE.PerspectiveCamera(60,window.innerWidth/window.innerHeight,0.1,1000);
  camera.position.z=50;
  var count=300;var geo=new THREE.BufferGeometry();
  var pos=new Float32Array(count*3);var vel=[];var sizes=new Float32Array(count);
  for(var i=0;i<count;i++){
    pos[i*3]=(Math.random()-0.5)*140;pos[i*3+1]=(Math.random()-0.5)*140;pos[i*3+2]=(Math.random()-0.5)*80;
    sizes[i]=0.2+Math.random()*0.6;
    vel.push({x:(Math.random()-0.5)*0.015,y:(Math.random()-0.5)*0.015,z:(Math.random()-0.5)*0.008});
  }
  geo.setAttribute('position',new THREE.BufferAttribute(pos,3));
  geo.setAttribute('size',new THREE.BufferAttribute(sizes,1));
  var vs='attribute float size;varying float vA;void main(){vec4 mv=modelViewMatrix*vec4(position,1.0);gl_PointSize=size*(200.0/-mv.z);gl_Position=projectionMatrix*mv;vA=clamp(1.0-(-mv.z/60.0),0.1,0.7);}';
  var fs='varying float vA;void main(){float d=length(gl_PointCoord-vec2(0.5));if(d>0.5)discard;float s=1.0-smoothstep(0.15,0.5,d);gl_FragColor=vec4(0.224,0.773,0.733,vA*s);}';
  var mat=new THREE.ShaderMaterial({vertexShader:vs,fragmentShader:fs,transparent:true,depthWrite:false});
  var pts=new THREE.Points(geo,mat);scene.add(pts);
  var mouse={x:0,y:0};
  window.addEventListener('mousemove',function(e){mouse.x=(e.clientX/window.innerWidth-0.5)*2;mouse.y=(e.clientY/window.innerHeight-0.5)*2;});
  window.addEventListener('resize',function(){camera.aspect=window.innerWidth/window.innerHeight;camera.updateProjectionMatrix();renderer.setSize(window.innerWidth,window.innerHeight);});
  function animate(){
    requestAnimationFrame(animate);var p=geo.attributes.position.array;
    for(var i=0;i<count;i++){var ix=i*3;
      p[ix]+=vel[i].x+Math.sin(Date.now()*0.0008+i)*0.008;
      p[ix+1]+=vel[i].y+Math.cos(Date.now()*0.0006+i)*0.005;p[ix+2]+=vel[i].z;
      if(p[ix]>70)p[ix]=-70;if(p[ix]<-70)p[ix]=70;
      if(p[ix+1]>70)p[ix+1]=-70;if(p[ix+1]<-70)p[ix+1]=70;
    }
    geo.attributes.position.needsUpdate=true;
    camera.position.x+=(mouse.x*3-camera.position.x)*0.02;
    camera.position.y+=(-mouse.y*2-camera.position.y)*0.02;
    camera.lookAt(0,0,0);pts.rotation.y+=0.0002;renderer.render(scene,camera);
  }
  animate();
})();

/* === SCROLL === */
window.addEventListener('scroll',function(){
  document.getElementById('siteHeader').classList.toggle('scrolled',window.scrollY>80);
  var cards=document.querySelectorAll('.disco-card:not(.visible)');
  for(var i=0;i<cards.length;i++){
    if(cards[i].getBoundingClientRect().top<window.innerHeight-40)cards[i].classList.add('visible');
  }
},{passive:true});

/* === LIVE2D MIKU (PixiJS-based) === */
const live2dMessages={
  idle:["Hi there! I'm Miku! ‚ô™","Welcome to my world!","Click a song to play!"],
  playing:["Great choice! ‚ô™","I love this song!","Let's dance together!"],
  paused:["Taking a break?","Miss me?","Ready when you are!"],
  hover:["That looks interesting!","Click it!","Nice choice!"]
};

let currentMessageIndex=0;
let messageTimeout=null;

function showMessage(type){
  const msgEl=document.getElementById('live2dMessage');
  const messages=live2dMessages[type]||live2dMessages.idle;
  const msg=messages[Math.floor(Math.random()*messages.length)];
  msgEl.textContent=msg;
  msgEl.classList.add('show');
  if(messageTimeout)clearTimeout(messageTimeout);
  messageTimeout=setTimeout(()=>msgEl.classList.remove('show'),4000);
}

(function initLive2D(){
  const container=document.getElementById('live2dContainer');
  const toggle=document.getElementById('live2dToggle');
  const canvas=document.getElementById('live2dCanvas');
  let visible=false;
  
  // Simple animated Miku using PixiJS
  const app=new PIXI.Application({
    view:canvas,
    width:350,
    height:450,
    transparent:true,
    antialias:true
  });
  
  // Create Miku container
  const miku=new PIXI.Container();
  app.stage.addChild(miku);
  miku.x=175;
  miku.y=400;
  
  // Body (simple shapes forming a chibi Miku)
  const body=new PIXI.Graphics();
  body.beginFill(0x39c5bb);
  body.drawEllipse(0,-80,60,70);
  body.endFill();
  
  // Head
  const head=new PIXI.Graphics();
  head.beginFill(0xffdbac);
  head.drawCircle(0,-160,55);
  head.endFill();
  
  // Hair (teal)
  const hair=new PIXI.Graphics();
  hair.beginFill(0x39c5bb);
  hair.drawEllipse(0,-170,70,60);
  hair.drawRect(-75,-170,20,120);
  hair.drawRect(55,-170,20,120);
  hair.endFill();
  
  // Twintails
  const leftTail=new PIXI.Graphics();
  leftTail.beginFill(0x39c5bb);
  leftTail.moveTo(-60,-150);
  leftTail.bezierCurveTo(-100,-100,-120,50,-80,150);
  leftTail.bezierCurveTo(-60,100,-50,0,-50,-140);
  leftTail.endFill();
  
  const rightTail=new PIXI.Graphics();
  rightTail.beginFill(0x39c5bb);
  rightTail.moveTo(60,-150);
  rightTail.bezierCurveTo(100,-100,120,50,80,150);
  rightTail.bezierCurveTo(60,100,50,0,50,-140);
  rightTail.endFill();
  
  // Eyes
  const leftEye=new PIXI.Graphics();
  leftEye.beginFill(0x39c5bb);
  leftEye.drawEllipse(-20,-155,12,16);
  leftEye.endFill();
  leftEye.beginFill(0x000000);
  leftEye.drawCircle(-20,-155,5);
  leftEye.endFill();
  leftEye.beginFill(0xffffff);
  leftEye.drawCircle(-17,-158,3);
  leftEye.endFill();
  
  const rightEye=new PIXI.Graphics();
  rightEye.beginFill(0x39c5bb);
  rightEye.drawEllipse(20,-155,12,16);
  rightEye.endFill();
  rightEye.beginFill(0x000000);
  rightEye.drawCircle(20,-155,5);
  rightEye.endFill();
  rightEye.beginFill(0xffffff);
  rightEye.drawCircle(23,-158,3);
  rightEye.endFill();
  
  // Blush
  const blush=new PIXI.Graphics();
  blush.beginFill(0xffaaaa,0.4);
  blush.drawEllipse(-35,-145,8,5);
  blush.drawEllipse(35,-145,8,5);
  blush.endFill();
  
  // Tie
  const tie=new PIXI.Graphics();
  tie.beginFill(0x333333);
  tie.moveTo(0,-120);
  tie.lineTo(-15,-100);
  tie.lineTo(0,-80);
  tie.lineTo(15,-100);
  tie.endFill();
  
  // Headphones
  const phones=new PIXI.Graphics();
  phones.lineStyle(4,0x333333);
  phones.moveTo(-55,-160);
  phones.quadraticCurveTo(0,-220,55,-160);
  phones.lineStyle(0);
  phones.beginFill(0x333333);
  phones.drawRect(-65,-175,15,35);
  phones.drawRect(50,-175,15,35);
  phones.endFill();
  
  // Add all parts
  miku.addChild(leftTail,rightTail,body,head,hair,phones,leftEye,rightEye,blush,tie);
  
  // Animation variables
  let time=0;
  let mouseX=0,mouseY=0;
  let targetX=0,targetY=0;
  
  // Track mouse
  document.addEventListener('mousemove',(e)=>{
    const rect=canvas.getBoundingClientRect();
    mouseX=(e.clientX-rect.left-175)/175;
    mouseY=(e.clientY-rect.top-200)/200;
    mouseX=Math.max(-1,Math.min(1,mouseX));
    mouseY=Math.max(-1,Math.min(1,mouseY));
  });
  
  // Breathing and looking animation
  app.ticker.add(()=>{
    time+=0.05;
    
    // Smooth follow
    targetX+=(mouseX*15-targetX)*0.1;
    targetY+=(mouseY*10-targetY)*0.1;
    
    // Body breathing
    miku.scale.y=1+Math.sin(time)*0.02;
    miku.scale.x=1+Math.cos(time)*0.01;
    
    // Head tilting
    head.x=targetX*0.5;
    head.y=targetY*0.3+Math.sin(time)*2;
    hair.x=head.x;
    hair.y=head.y;
    leftEye.x=head.x;
    leftEye.y=head.y;
    rightEye.x=head.x;
    rightEye.y=head.y;
    blush.x=head.x;
    blush.y=head.y;
    phones.x=head.x;
    phones.y=head.y;
    tie.y=Math.sin(time)*1;
    
    // Twintails sway
    leftTail.rotation=Math.sin(time*0.8)*0.05+targetX*0.02;
    rightTail.rotation=-Math.sin(time*0.8+0.5)*0.05+targetX*0.02;
    leftTail.x=head.x*0.3;
    rightTail.x=head.x*0.3;
  });
  
  // Toggle visibility
  toggle.addEventListener('click',()=>{
    visible=!visible;
    container.classList.toggle('visible',visible);
    if(visible)showMessage('idle');
  });
  
  // Show after delay
  setTimeout(()=>{
    container.classList.add('visible');
    visible=true;
    showMessage('idle');
  },5500);
  
  // Hover effects on cards
  document.querySelectorAll('.disco-card').forEach(card=>{
    card.addEventListener('mouseenter',()=>{if(visible&&Math.random()>0.6)showMessage('hover');});
  });
  
  // Expose for music player
  window.live2dMiku={showMessage,miku};
})();

/* === YOUTUBE PLAYER === */
var ytReady=false,ytPlayerObj=null,currentCard=null,progressInterval=null;
var tag=document.createElement('script');tag.src='https://www.youtube.com/iframe_api';document.head.appendChild(tag);

function onYouTubeIframeAPIReady(){
  ytPlayerObj=new YT.Player('ytPlayer',{
    height:'1',width:'1',
    playerVars:{autoplay:0,controls:0,disablekb:1,fs:0,modestbranding:1},
    events:{
      onReady:function(){ytReady=true;},
      onStateChange:function(e){
        if(e.data===YT.PlayerState.ENDED)stopSong();
        if(e.data===YT.PlayerState.PLAYING){
          startProgress();
          if(window.live2dMiku)window.live2dMiku.showMessage('playing');
        }
        if(e.data===YT.PlayerState.PAUSED){
          clearInterval(progressInterval);
          if(window.live2dMiku)window.live2dMiku.showMessage('paused');
        }
      }
    }
  });
}

function playSong(card){
  if(!ytReady)return;
  if(currentCard===card){
    var state=ytPlayerObj.getPlayerState();
    if(state===YT.PlayerState.PLAYING){ytPlayerObj.pauseVideo();card.classList.remove('playing');document.getElementById('playBtn').innerHTML='&#9654;';}
    else{ytPlayerObj.playVideo();card.classList.add('playing');document.getElementById('playBtn').innerHTML='&#10074;&#10074;';}
    return;
  }
  if(currentCard)currentCard.classList.remove('playing');
  currentCard=card;card.classList.add('playing');
  document.getElementById('trackName').textContent=card.querySelector('h3').textContent+' \u2014 '+card.querySelector('.song-artist').textContent;
  document.getElementById('playBtn').innerHTML='&#10074;&#10074;';
  document.getElementById('musicPlayer').classList.add('visible');
  ytPlayerObj.loadVideoById(card.dataset.video);
}

function startProgress(){
  clearInterval(progressInterval);
  progressInterval=setInterval(function(){
    if(!ytPlayerObj||ytPlayerObj.getPlayerState()!==YT.PlayerState.PLAYING)return;
    var c=ytPlayerObj.getCurrentTime(),d=ytPlayerObj.getDuration();if(d<=0)return;
    document.getElementById('progressFill').style.width=(c/d)*100+'%';
    var cm=Math.floor(c/60),cs=Math.floor(c%60),tm=Math.floor(d/60),ts=Math.floor(d%60);
    document.getElementById('playerTime').textContent=cm+':'+(cs<10?'0':'')+cs+' / '+tm+':'+(ts<10?'0':'')+ts;
  },500);
}

function stopSong(){
  clearInterval(progressInterval);if(currentCard)currentCard.classList.remove('playing');currentCard=null;
  document.getElementById('playBtn').innerHTML='&#9654;';
  document.getElementById('progressFill').style.width='0%';
  document.getElementById('playerTime').textContent='0:00 / 0:00';
  document.getElementById('trackName').textContent='Select a track';
}

window.togglePlay=function(){
  if(!ytReady||!ytPlayerObj)return;
  var state=ytPlayerObj.getPlayerState();
  if(state===YT.PlayerState.PLAYING){ytPlayerObj.pauseVideo();if(currentCard)currentCard.classList.remove('playing');document.getElementById('playBtn').innerHTML='&#9654;';}
  else if(currentCard){ytPlayerObj.playVideo();currentCard.classList.add('playing');document.getElementById('playBtn').innerHTML='&#10074;&#10074;';}
};

window.seekTrack=function(e){
  if(!ytReady||!ytPlayerObj)return;
  var bar=document.getElementById('progressBar'),rect=bar.getBoundingClientRect();
  var d=ytPlayerObj.getDuration();if(d>0)ytPlayerObj.seekTo(((e.clientX-rect.left)/rect.width)*d,true);
};
</script>
</body>
</html>
